<ng-container *ngIf="(request$ | async) as request; else loading">
      <app-request-commercial-proposals
        *ngIf="(requestPositionsWithOffers$ | async) as positionsWithOffers"
        [requestPositions]="positionsWithOffers.positions"
        [suppliers]="positionsWithOffers.suppliers"
        (sentForAgreement)="sendForAgreement($event.requestId, $event.selectedPositions)"
        (cancelOffer)="onCancelPublishOffers($event)"
        (addOffer)="showAddOfferModal($event)"
        (editOffer)="showEditOfferModal($event)"
      ></app-request-commercial-proposals>
</ng-container>

<ng-template #loading>
  <div class="text-center">
    <span class="spinner spinner-md"></span>
  </div>
</ng-template>

<clr-modal #requestCommercialProposalModal
           class="cp-creation-modal"
           [(clrModalOpen)]="showForm"
           [clrModalSize]="'lg'">
  <h2 class="modal-title">Добавить новое коммерческое предложение</h2>

  <div class="modal-body">
    <app-request-commercial-proposals-create
            *ngIf="requestCommercialProposalModal._open"
            (cancel)="requestCommercialProposalModal.close()"
            [position]="currentRequestPosition"
            (addOffer)="addCommercialProposal(); requestCommercialProposalModal.close()"
    >
    </app-request-commercial-proposals-create>
  </div>
</clr-modal>



<clr-modal #requestCommercialProposalEditModal
           class="cp-edit-modal"
           [(clrModalOpen)]="showEditForm"
           [clrModalSize]="'lg'">
  <h2 class="modal-title">Редактирование коммерческого предложения</h2>

  <div class="modal-body">
    <app-request-commercial-proposals-edit
            *ngIf="requestCommercialProposalEditModal._open"
            (cancel)="requestCommercialProposalEditModal.close()"
            [position]="currentRequestPosition"
            [selectedOffer]="selectedLinkedOffer"
            (editOffer)="editCommercialProposal(); requestCommercialProposalEditModal.close()">
    </app-request-commercial-proposals-edit>
  </div>
</clr-modal>
