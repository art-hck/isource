<form [formGroup]="form" (ngSubmit)="submit()" class="app-card">

  <div class="app-row app-align-items-center">
    <div class="app-col"><h3>Создать ценовой запрос</h3></div>
    <button type="button" uxgButton icon link (click)="close.emit()">
      <clr-icon shape="app-cross"></clr-icon>
    </button>
  </div>


  <div class="app-control-wrap">
    <input #nameRef uxgInput lg formControlName="name"/>
    <label class="app-control-label" (click)="nameRef.focus()">Имя ценового запроса</label>
    <div class="app-control-error" *ngIf="form.get('name').errors as e">
      <span *ngIf="e.required">Обязательное поле</span>
    </div>
  </div>

  <div *ngFor="let formGroup of formPositions().controls; index as i" formArrayName="positions">
    <div class="app-row app-align-items-center" formGroupName="{{i}}">
      <div class="app-col app-control-wrap">
        <input #nameRef uxgInput lg formControlName="name"/>
        <label class="app-control-label" (click)="nameRef.focus()">Имя позиции</label>
      </div>
      <button uxgButton outline lg icon type="button" (click)="formPositions().removeAt(i)">
        <clr-icon shape="app-trash"></clr-icon>
      </button>
    </div>
  </div>
  <p class="app-error-color text-center app-bold" *ngIf="formPositions()?.errors as e">
    <span *ngIf="e.required">Добавьте хотя бы одну позицию</span>
  </p>

  <div class="app-row app-justify-content-end app-section">
    <button uxgButton primary [disabled]="form.invalid || form.disabled">Создать</button>
    <button uxgButton secondary type="button" (click)="formPositions().push(getFormPosition())">Добавить позицию</button>
  </div>
</form>
