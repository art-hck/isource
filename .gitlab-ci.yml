stages:
  - build
  - codestyle

build staging:
  stage: build
  tags:
    - gpn-test-front
  script:
    - pwd | xargs /bin/bash /var/agent/front/01.sync.sh
    - /bin/bash /var/agent/front/02.npm_install.sh
    - /bin/bash /var/agent/front/03.ng_build_prod.sh
    - /bin/bash /var/agent/front/04.change_girs.sh
    - exit 0
  only:
    - dev

codestyle staging:
  stage: codestyle
  tags:
    - gpn-test-front
  script:
    - cd www
    - npm i tslint --no-optional
    - npm run tslint
    - exit 0
  only:
    - merge_requests


build preprod:
  stage: build
  tags:
    - gpn-preprod-front
  script:
    - pwd | xargs /bin/bash /var/www/agent/front/01.sync.sh
    - /bin/bash /var/www/agent/front/02.npm_install.sh
    - /bin/bash /var/www/agent/front/03.ng_build.sh
    - /bin/bash /var/www/agent/front/04.change_girs.sh
    - exit 0
  only:
    - release

build prod:
  stage: build
  tags:
    - gpn-prod-front
  script:
    - pwd | xargs /bin/bash /var/www/agent/front/01.sync.sh
    - /bin/bash /var/www/agent/front/02.npm_install.sh
    - /bin/bash /var/www/agent/front/03.ng_build.sh
    - /bin/bash /var/www/agent/front/04.change_girs.sh
    - exit 0
  only:
    - master
  when: manual
